FROM debian:12


# 安装所有必要的依赖
RUN apt-get update && apt-get install -y \
    curl \
    procps \
    bc \
    jq \
    && rm -rf /var/lib/apt/lists/*

# 创建工作目录
WORKDIR /app

# 复制脚本到容器中
COPY monitor.sh .
COPY monitor-daemon.sh .

# 给脚本添加执行权限
RUN chmod +x monitor.sh monitor-daemon.sh

# 调试：验证文件是否存在
RUN ls -la /app/

# 创建日志文件
RUN touch /var/log/monitor.log

# 启动监控守护进程
ENTRYPOINT ["/bin/bash"]
CMD ["/app/monitor-daemon.sh"]